<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Checkout — Viral Dead Engine</title>
  <link rel="stylesheet" href="/assets/styles.css">
  <style>
    .panel{border:1px solid rgba(255,255,255,.12);border-radius:16px;background:#151515;padding:16px}
    .cta{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .input{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,.14);background:#0f0f0f;color:#fff}
  </style>
  <script>
    window.VD_TRACKING = window.VD_TRACKING || {
      endpoint: "/api/track",
      utm: { utm_source:"deadapp", utm_medium:"site", utm_campaign:"viral_dead_engine" }
    };
  </script>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div>
        <h1 style="margin:0 0 6px">Get access.</h1>
        <p style="margin:0;opacity:.82">Monthly to start. Switch to yearly anytime in the billing portal.</p>
      </div>
      <div class="nav">
        <a href="/">Home</a> · <a href="/course.html">Course</a> · <a href="/how-it-works.html">How it works</a> · <a href="/account.html">Account</a>
      </div>
    </div>

    <div class="panel">
      <p style="margin:0 0 12px">
        You’re not buying motivation. You’re buying <b>clarity, structure, and forward motion</b>.
      </p>

      <p style="margin:0 0 10px"><b>API base URL</b> (your backend). For prod, set once to your deployed API.</p>
      <input id="apiBase" class="input" placeholder="https://viraldeadengine-1.onrender.com" />

      <div class="cta">
        <button class="ts-btn" id="startCheckout" type="button">Continue to secure checkout →</button>
        <a class="ts-btnlink" data-track="checkout_how" href="/how-it-works.html">See how it works →</a>
      </div>
      <p style="margin-top:10px;opacity:.7;font-size:.9rem;line-height:1.5">
        After checkout you’ll land on <code>/success.html</code>. Manage billing anytime from <code>/account.html</code>.
      </p>
      <div id="msg" style="margin-top:10px;opacity:.85"></div>
    </div>
  </div>

<script>
  const msg = (t)=>document.getElementById("msg").textContent=t;
  const API_BASE = "https://viraldeadengine-1.onrender.com";
  const apiBase = document.getElementById("apiBase");
  apiBase.value = DEFAULT_API_BASE;

  async function call(path, payload){
    const api = (apiBase.value.trim() || API_BASE).replace(/\/$/,"");
    localStorage.setItem("vd_api_base", api);
    const res = await fetch(api + path, {
      method: "POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify(payload || {})
    });
    const data = await res.json().catch(()=>({}));
    if(!res.ok) throw new Error(data.detail || "Request failed");
    return data;
  }

  document.getElementById("startCheckout").onclick = async ()=>{
    try{
      msg("Creating checkout session…");
      const out = await call("/stripe/create-checkout-session", {
        price_id: "price_1SuDbbKC49F2A9OzmzeLK6BD",
        success_url: "https://viraldead.pro/success.html",
        cancel_url: "https://viraldead.pro/cancel.html"
      });
      window.location.href = out.url;
    }catch(e){ msg(e.message); }
  };
</script>
<script src="/assets/turnstile.js"></script>

  <div class="divider"></div>
  <div class="footer-links">
    <b>Our network:</b>
    <a href="https://deadapp.pro" target="_blank" rel="noopener">DeadApp.pro</a> ·
    <a href="https://insuretoday24.com" target="_blank" rel="noopener">InsureToday24.com</a> ·
    <a href="https://viraldead.pro" target="_blank" rel="noopener">ViralDead.pro</a>
  </div>

</body>
</html>
